--THE FILES ARE UPLOADED , BEFORE STARING THE QUESTIONS  ANALYSE THE DATA 

----------------------------------------
Part 1: Basic Retrieval & Aggregation
-----------------------------------------
1. Display the number of states present in the Location Table.
SELECT COUNT(DISTINCT State) AS Total_States 
FROM LocationTable;


2. How many products are of regular type?**
SELECT COUNT(*) AS Regular_Product_Count 
FROM ProductTable 
WHERE Type = 'Regular';


3. How much spending has been done on marketing of product ID 1?

SELECT SUM(Marketing) AS Total_Marketing_Spend 
FROM FactTable 
WHERE ProductId = 1;
[cite_start]``` [cite: 24]

4. What is the minimum sales of a product?**

SELECT MIN(Sales) AS Minimum_Sales 
FROM FactTable;


5. Display the max Cost of Good Sold (COGS).

SELECT MAX(COGS) AS Max_COGS 
FROM FactTable;


6. Display the details of the product where product type is coffee.

SELECT * FROM ProductTable 
WHERE [Product Type] = 'Coffee';

**7. Display the details where total expenses are greater than 40.**

SELECT * FROM FactTable 
WHERE [Total Expenses] > 40;


**8. What is the average sales in area code 719?**

SELECT AVG(Sales) AS Average_Sales 
FROM FactTable 
WHERE [Area Code] = 719;


**9. Find out the total profit generated by Colorado state.**

SELECT SUM(f.Profit) AS Total_Colorado_Profit
FROM FactTable f
JOIN LocationTable l ON f.[Area Code] = l.[Area Code]
WHERE l.State = 'Colorado';


----------------------------------------------------------

 **Part 2: Joins and Grouping**
----------------------------------------------------
**10. Display the average inventory for each product ID.**

SELECT ProductId, AVG(Inventory) AS Average_Inventory 
FROM FactTable 
GROUP BY ProductId;


**11. Display state in a sequential order in a Location Table.**

SELECT DISTINCT State 
FROM LocationTable 
ORDER BY State ASC;


**12. Display the average budget of the Product where the average budget margin should be greater than 100.**

SELECT ProductId, AVG([Budget Sales]) AS Average_Budget_Sales
FROM FactTable
GROUP BY ProductId
HAVING AVG([Budget Margin]) > 100;


**13. What is the total sales done on date 2010-01-01?**

SELECT SUM(Sales) AS Total_Sales 
FROM FactTable 
WHERE Date = '2010-01-01';


**14. Display the average total expense of each product ID on an individual date.**

SELECT Date, ProductId, AVG([Total Expenses]) AS Average_Expense
FROM FactTable
GROUP BY Date, ProductId;


**15. Display the table with the following attributes such as date, product ID, product_type, product, sales, profit, state, area_code.**

SELECT f.Date, f.ProductId, p.[Product Type], p.Product, f.Sales, f.Profit, l.State, f.[Area Code]
FROM FactTable f
JOIN ProductTable p ON f.ProductId = p.ProductId
JOIN LocationTable l ON f.[Area Code] = l.[Area Code];


**16. Display the rank without any gap to show the sales wise rank.**

SELECT *, DENSE_RANK() OVER (ORDER BY Sales DESC) AS Sales_Rank
FROM FactTable;


**17. Find the state wise profit and sales.**

SELECT l.State, SUM(f.Profit) AS Total_Profit, SUM(f.Sales) AS Total_Sales
FROM FactTable f
JOIN LocationTable l ON f.[Area Code] = l.[Area Code]
GROUP BY l.State;


**18. Find the state wise profit and sales along with the product name.**

SELECT l.State, p.Product, SUM(f.Profit) AS Total_Profit, SUM(f.Sales) AS Total_Sales
FROM FactTable f
JOIN LocationTable l ON f.[Area Code] = l.[Area Code]
JOIN ProductTable p ON f.ProductId = p.ProductId
GROUP BY l.State, p.Product;


-------------------------------------------
**Part 3: Advanced Logic and DML**
-------------------------------------------------
**19. If there is an increase in sales of 5%, calculate the increased sales.**

SELECT Sales, (Sales * 1.05) AS Increased_Sales 
FROM FactTable;


**20. Find the maximum profit along with the product ID and producttype.**

SELECT f.Profit, f.ProductId, p.[Product Type]
FROM FactTable f
JOIN ProductTable p ON f.ProductId = p.ProductId
WHERE f.Profit = (SELECT MAX(Profit) FROM FactTable);


**21. Create a stored procedure to fetch the result according to the product type from Product Table.**

CREATE PROCEDURE GetProductsByType
    @PType VARCHAR(50)
AS
BEGIN
    SELECT * FROM ProductTable WHERE [Product Type] = @PType;
END;


**22. Write a query by creating a condition in which if the total expenses is less than 60 then it is a profit or else loss.**

SELECT *, 
       CASE WHEN [Total Expenses] < 60 THEN 'Profit' ELSE 'Loss' END AS Performance_Status
FROM FactTable;


**23. Give the total weekly sales value with the date and product ID details. Use roll-up to pull the data in hierarchical order.**

SELECT Date, ProductId, SUM(Sales) AS Total_Sales
FROM FactTable
GROUP BY ROLLUP (Date, ProductId);


**24. Apply union and intersection operator on the tables which consist of attribute area code.**

-- Union
SELECT [Area Code] FROM FactTable
UNION
SELECT [Area Code] FROM LocationTable;

-- Intersection
SELECT [Area Code] FROM FactTable
INTERSECT
SELECT [Area Code] FROM LocationTable;


**25. Create a user-defined function for the product table to fetch a particular product type based upon the user's preference.**

CREATE FUNCTION GetProductByPreference (@UserPref VARCHAR(50))
RETURNS TABLE
AS
RETURN (SELECT * FROM ProductTable WHERE [Product Type] = @UserPref);


**26. Change the product type from coffee to tea where product ID is 1 and undo it.**

-- Change
UPDATE ProductTable SET [Product Type] = 'Tea' WHERE ProductId = 1;

-- Undo
UPDATE ProductTable SET [Product Type] = 'Coffee' WHERE ProductId = 1;


**27. Display the date, product ID and sales where total expenses are between 100 to 200.**

SELECT Date, ProductId, Sales 
FROM FactTable 
WHERE [Total Expenses] BETWEEN 100 AND 200;


**28. Delete the records in the Product Table for regular type.**

DELETE FROM ProductTable WHERE Type = 'Regular';


**29. Display the ASCII value of the fifth character from the column Product.**

SELECT Product, ASCII(SUBSTRING(Product, 5, 1)) AS ASCII_5th_Char 
FROM ProductTable;


  ---------------------------------------------- THIS QUESTIONS  HELPS U ALOT----------------------
