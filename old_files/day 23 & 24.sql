                 ----------DAY 23 & 24  ()----------------
use ZOHO
SELECT *FROM STAFF

-- NVarchar and Nchar.
varchar - ASCII(A,B,&,7)
create table VARCHAR_X(Name varchar(30))
insert into VARCHAR_X values('Jay')
insert into VARCHAR_X values('??')
select * from VARCHAR_X

--Nvarchar :- UNICODE
create table NVARCHAR_X(Name Nvarchar(30))
insert into NVARCHAR_X values('Jay')
insert into NVARCHAR_X values('??')
insert into NVARCHAR_X values(N'??')
select * from NVARCHAR_X
insert into NVARCHAR_X values(N'???')


 /* Create a customer table which comprises of these columns: ‘customer_id’,
‘first_name’, ‘last_name’, ‘email’, ‘address’, ‘city’,’state’,’zip’ */
-- Insert 5 rows into the customer table

--Select only the ‘first_name’ and ‘last_name’ columns from the customer table
---Select those records where ‘first_name’ starts with “G” and city is ‘SanJose’. 
---Select those records where Email has only ‘gmail’. 
---Select those records where the ‘last_name’ doesn't end with “A”.


create table customer_table
(customer_id int, first_name varchar(250), last_name varchar(259),email varchar(250), address varchar(250),city varchar(250),
state varchar(250),zip int)

insert into customer_TABLE values
(1, 'Gaurav', 'Mehta', 'gaurav@gmail.com', 'MG Road', 'SanJose', 'CA', '95112'),
(2, 'Rohan', 'Sharma', 'rohan@yahoo.com', 'Park Street', 'Delhi', 'DL', '110001'),
(3, 'Geeta', 'Verma', 'geeta@gmail.com', 'Lake View', 'SanJose', 'CA', '95110'),
(4, 'Amit', 'Kapoor', 'amit@gmail.com', 'Hill Road', 'Mumbai', 'MH', '400001'),
(5, 'Gopal', 'Singh', 'gopal@hotmail.com', 'Ring Road', 'Jaipur', 'RJ', '302001')

select  *from customer_table
select first_name, last_name from customer_table
select *,concat(first_name,'   ' ,last_name) from customer_table
select * from customer_table where first_name like 'G%' and city = 'SanJose' 
select  *,email from customer_table where email like ('%gmail.COM')
select last_name from customer_table where  last_name not like ('%A')



/*Create a customer_X table which comprises of these columns: ‘customer_id’,
‘first_name’, ‘last_name’,'phone number'*/

--2. Insert 5 new records into the table

--Create an ‘Orders’ table which comprises of these columns: ‘order_id’,
--order_date’, ‘amount’, ‘customer_id’.

--Insert 5 new records.
--Make an inner join on ‘Customer’ and ‘Orders’ tables on the ‘customer_id’ column.

-- Make left joins on ‘Customer’ and ‘Orders’ tables on the‘customer_id’ column

--Make right joins on ‘Customer’ and ‘Orders’ tables on the‘customer_id’ column

--Make a full outer join on ‘Customer’ and ‘Orders’ table on the ‘customer_id’ column.


 -- create customer_X table
create table customer_X (
customer_id int,
first_name varchar(50),
last_name varchar(50),
phone_number varchar(15)
);

-- insert 5 records into customer_X
insert into customer_X values
(1,'rahul','sharma','9876543210'),
(2,'priya','verma','8765432109'),
(3,'amit','singh','9854321098'),
(4,'neha','patel','9543210987'),
(5,'rohit','mehta','6332109876');

-- create Orders table
create table Orders (
order_id int,
order_date date,
amount decimal(10,2),
customer_id int
);

-- insert 5 records into Orders
insert into Orders values
(101,'2026-01-01',2500.00,1),
(102,'2026-01-05',1500.00,2),
(103,'2026-01-10',3200.00,3),
(104,'2026-01-15',4500.00,4),
(105,'2026-01-20',2800.00,5);

-- inner join Customer_X and Orders on customer_id
select  *from customer_X c inner join Orders o
on c.customer_id = o.customer_id;

-- left join Customer_X and Orders on customer_id
select *from customer_X c
left join Orders o
on c.customer_id = o.customer_id;

select  *from customer_table t 
full join Orders o
on t.customer_id = o.customer_id;



use zoho
select *from location
select *from fact
select *from product

 --1. Display the number of states present in the LocationTable
--2.How many products are of regular type?
--3.How much spending has been done on marketing of product ID 1?
--4. What is the minimum sales of a products?
--5. Display the max Cost of Good Sold (COGS).
--6. Display the details of the product where product type is coffee. 

--1
select count(distinct state)  from location

--2
select count(*) from product where type = 'regular' 

--3
select sum(marketing) from fact where productid = 1

--4
select min(sales) from fact

--5
select max(cogs) from fact

--6
select *from product where product_type = 'coffee'

 --7. Display the details where total expenses are greater than 40.
 select *from fact where total_expenses > 40

--8. What is the average sales in area code 719?
select avg(sales) from fact where area_code = 719

--9. Find out the total profit generated by Colorado state.
select sum(profit) from fact f inner  join location l on f.area_code = l.area_code where state = 'colorado'

--10. Display the average inventory for each product ID.
select productid,avg(Inventory) from fact group by ProductId order by productid

--11. Display state in a sequential order in a Location Table.
select State from Location group by State

--13. What is the total sales done on date 2010-01-01?
select sum(sales) from fact where date =   '2010-01-01'



--14. Display the average total expense of each product ID on an individual date.
select date,productid, avg(total_expenses)  from fact  group by date , productid

--15. Display the table with the following attributes such as date, productID, product_type, product,
--sales, profit, state, area_code
select f.date , f.productid, p.product_type,p.product, f.sales , f.profit, l.state, f.area_code
from location l  join fact f on l.area_code = f.area_code join product p on p.productid = f.productid

--16. Display the rank without any gap to show the sales wise rank.
select sales ,DENSE_RANK() over (order by sales desc) from fact

--17. Find the state wise profit and sales. 
select sum(f.profit) , sum(f.sales) ,l.state from fact f  join  location l on l.area_code =  f.area_code group by l.state

--18. Find the state wise profit and sales along with the productname.
select product,state,sum(profit) , sum(sales)  from fact f inner  join  product p on p.productid =  f.productid inner join 
location  l on l.area_code =  f.area_code group by state,product
